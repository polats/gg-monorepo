# Bazaar x402 Example Configuration
# Copy this file to .env and configure for your environment

# ============================================
# Payment Mode Configuration
# ============================================

# Payment mode: "mock" or "production"
# - mock: Use in-memory currency for development/testing (no blockchain)
# - production: Use real Solana USDC payments via x402 protocol
PAYMENT_MODE=production

# ============================================
# Solana Network Configuration
# ============================================

# Solana network: "devnet" or "mainnet"
# - devnet: Use Solana devnet for testing with test USDC
# - mainnet: Use Solana mainnet for production with real USDC
SOLANA_NETWORK=devnet

# ============================================
# RPC Endpoints
# ============================================

# Solana devnet RPC endpoint
# Default: https://api.devnet.solana.com
# For better performance, consider using a dedicated RPC provider:
# - Helius: https://devnet.helius-rpc.com/?api-key=YOUR_KEY
# - QuickNode: https://your-endpoint.solana-devnet.quiknode.pro/YOUR_KEY/
SOLANA_DEVNET_RPC=https://api.devnet.solana.com

# Solana mainnet RPC endpoint
# Default: https://api.mainnet-beta.solana.com
# For production, use a dedicated RPC provider for reliability:
# - Helius: https://mainnet.helius-rpc.com/?api-key=YOUR_KEY
# - QuickNode: https://your-endpoint.solana-mainnet.quiknode.pro/YOUR_KEY/
SOLANA_MAINNET_RPC=https://api.mainnet-beta.solana.com

# ============================================
# USDC Token Mint Addresses
# ============================================

# USDC mint address on Solana devnet
# This is the official USDC devnet mint address
USDC_MINT_DEVNET=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU

# USDC mint address on Solana mainnet
# This is the official USDC mainnet mint address
USDC_MINT_MAINNET=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v

# ============================================
# Mock Mode Settings
# ============================================

# Default starting balance for new users in mock mode (in USDC)
# Users will start with this amount when first accessing the marketplace
MOCK_DEFAULT_BALANCE=1000

# Whether to use Redis for persistent mock mode storage
# - false: Use in-memory storage (data lost on restart)
# - true: Use Redis for persistent storage across restarts
MOCK_USE_REDIS=false

# Redis connection URL (only used if MOCK_USE_REDIS=true)
# Format: redis://[username:password@]host:port[/database]
# Examples:
# - Local: redis://localhost:6379
# - Remote: redis://user:pass@redis.example.com:6379/0
# MOCK_REDIS_URL=redis://localhost:6379

# Transaction ID prefix for mock transactions
# Mock transactions will be formatted as: {prefix}_{timestamp}_{random}
MOCK_TX_ID_PREFIX=MOCK

# ============================================
# Transaction Polling Configuration
# ============================================

# Maximum number of attempts to poll for transaction confirmation
# Higher values = more retries but longer wait times
# Recommended: 10-20 attempts
TX_POLL_MAX_ATTEMPTS=10

# Interval between polling attempts (in milliseconds)
# Lower values = faster confirmation but more RPC calls
# Recommended: 1000-3000ms (1-3 seconds)
TX_POLL_INTERVAL_MS=2000

# ============================================
# Balance Caching Configuration
# ============================================

# Duration to cache on-chain balance queries (in seconds)
# Reduces RPC calls but may show stale balances
# Set to 0 to disable caching
# Recommended: 30-60 seconds
BALANCE_CACHE_DURATION=30

# ============================================
# Example Configurations
# ============================================

# --- Development (Mock Mode) ---
# Use this for local development without blockchain
# PAYMENT_MODE=mock
# MOCK_DEFAULT_BALANCE=1000
# MOCK_USE_REDIS=false

# --- Testing (Devnet) ---
# Use this for testing with Solana devnet and test USDC
# PAYMENT_MODE=production
# SOLANA_NETWORK=devnet
# SOLANA_DEVNET_RPC=https://api.devnet.solana.com
# USDC_MINT_DEVNET=4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU

# --- Production (Mainnet) ---
# Use this for production with real Solana USDC
# PAYMENT_MODE=production
# SOLANA_NETWORK=mainnet
# SOLANA_MAINNET_RPC=https://your-rpc-provider.com
# USDC_MINT_MAINNET=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v

# ============================================
# Getting Test USDC on Devnet
# ============================================

# To test with devnet USDC:
# 1. Create a Solana wallet (e.g., using Phantom or Solflare)
# 2. Switch wallet to devnet
# 3. Get devnet SOL from faucet: https://faucet.solana.com/
# 4. Get devnet USDC from: https://spl-token-faucet.com/
# 5. Use your wallet address as buyer/seller in API calls

# ============================================
# Troubleshooting
# ============================================

# If transactions are not confirming:
# - Increase TX_POLL_MAX_ATTEMPTS
# - Increase TX_POLL_INTERVAL_MS
# - Check RPC endpoint is responding
# - Verify network matches wallet network

# If balance queries are slow:
# - Use a dedicated RPC provider (Helius, QuickNode)
# - Increase BALANCE_CACHE_DURATION
# - Check RPC rate limits

# If mock mode is not persisting:
# - Set MOCK_USE_REDIS=true
# - Configure MOCK_REDIS_URL
# - Ensure Redis is running
